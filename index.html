<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Printable Calendar Generator</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js" defer></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Roboto:wght@300;400;500;700&family=Playfair+Display:wght@400;500;600;700&family=Montserrat:wght@300;400;500;600&display=swap');
        
        .font-inter { font-family: 'Inter', sans-serif; }
        .font-roboto { font-family: 'Roboto', sans-serif; }
        .font-playfair { font-family: 'Playfair Display', serif; }
        .font-montserrat { font-family: 'Montserrat', sans-serif; }
        
        .moon-phase {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            display: inline-block;
            position: relative;
            overflow: hidden;
        }
        
        @media print {
            .no-print {
                display: none !important;
            }
            body {
                background: white !important;
                color: black !important;
            }
            .calendar-print {
                break-inside: avoid;
            }
        }
        @media print {
            .page-break {
                page-break-before: always;
                break-before: page;
            }

            .calendar-page,
            .daily-page {
                page-break-after: always;
                break-inside: avoid;
            }
        }
    </style>
</head>
<body class="bg-gray-100 font-inter" x-data="calendarApp()">
    <div class="container mx-auto p-4 max-w-6xl">
        <!-- Header -->
        <header class="bg-white rounded-lg shadow-md p-6 mb-6 no-print">
            <h1 class="text-3xl font-bold text-center text-indigo-700">Printable Calendar Generator</h1>
            <p class="text-gray-600 text-center mt-2">Create custom printable calendars with your preferred layout and design</p>
        </header>

        <div class="flex flex-col lg:flex-row gap-6">
            <!-- Configuration Panel -->
            <div class="w-full lg:w-1/3 bg-white rounded-lg shadow-md p-6 no-print" x-show="!generating">
                <h2 class="text-xl font-semibold mb-4 text-indigo-700">Calendar Settings</h2>
                
                <!-- View Mode Selection -->
                <div class="mb-6">
                    <h3 class="font-medium mb-2">View Mode</h3>
                    <div class="flex gap-4">
                        <button @click="viewMode = 'monthly'" 
                                :class="viewMode === 'monthly' ? 'bg-indigo-600 text-white' : 'bg-gray-200 text-gray-700'"
                                class="px-4 py-2 rounded-md transition">
                            Monthly
                        </button>
                        <button @click="viewMode = 'daily'" 
                                :class="viewMode === 'daily' ? 'bg-indigo-600 text-white' : 'bg-gray-200 text-gray-700'"
                                class="px-4 py-2 rounded-md transition">
                            Daily
                        </button>
                    </div>
                </div>
                
                <!-- Date Range -->
                <div class="mb-6">
                    <h3 class="font-medium mb-2">Date Range</h3>
                    <template x-if="viewMode === 'monthly'">
                        <div class="grid grid-cols-2 gap-4">
                            <div>
                                <label class="block text-sm mb-1">Start Month</label>
                                <input type="month" x-model="startMonth" class="w-full p-2 border rounded-md">
                            </div>
                            <div>
                                <label class="block text-sm mb-1">End Month</label>
                                <input type="month" x-model="endMonth" class="w-full p-2 border rounded-md">
                            </div>
                        </div>
                    </template>
                    <template x-if="viewMode === 'daily'">
                        <div class="grid grid-cols-2 gap-4">
                            <div>
                                <label class="block text-sm mb-1">Start Date</label>
                                <input type="date" x-model="startDate" class="w-full p-2 border rounded-md">
                            </div>
                            <div>
                                <label class="block text-sm mb-1">End Date</label>
                                <input type="date" x-model="endDate" class="w-full p-2 border rounded-md">
                            </div>
                        </div>
                    </template>
                </div>
                
                <!-- Layout Settings -->
                <div class="mb-6">
                    <h3 class="font-medium mb-2">Layout Settings</h3>
                    <div class="grid grid-cols-2 gap-4 mb-3">
                        <div>
                            <label class="block text-sm mb-1">Week Starts On</label>
                            <select x-model="weekStartsOn" class="w-full p-2 border rounded-md">
                                <option value="0">Sunday</option>
                                <option value="1">Monday</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm mb-1">Orientation</label>
                            <select x-model="orientation" class="w-full p-2 border rounded-md">
                                <option value="portrait">Portrait</option>
                                <option value="landscape">Landscape</option>
                            </select>
                        </div>
                    </div>
                    <div>
                        <label class="block text-sm mb-1">Layout Style</label>
                        <select x-model="layoutStyle" class="w-full p-2 border rounded-md">
                            <option value="minimalist">Minimalist</option>
                            <option value="detailed">Detailed</option>
                        </select>
                    </div>
                </div>
                
                <!-- Daily View Options -->
                <template x-if="viewMode === 'daily'">
                    <div class="mb-6">
                        <h3 class="font-medium mb-2">Daily View Options</h3>
                        <label class="flex items-center mb-2">
                            <input type="checkbox" x-model="showQuote" class="mr-2">
                            <span>Show Daily Quote</span>
                        </label>
                        <label class="flex items-center mb-2">
                            <input type="checkbox" x-model="showMoonPhase" class="mr-2">
                            <span>Show Moon Phase</span>
                        </label>
                        <div class="mt-3">
                            <label class="block text-sm mb-1">Time Format</label>
                            <select x-model="timeFormat" class="w-full p-2 border rounded-md">
                                <option value="24h">24-hour</option>
                                <option value="AM/PM">12-hour (AM/PM)</option>
                            </select>
                        </div>
                        <div class="grid grid-cols-2 gap-4 mt-3">
                            <div>
                                <label class="block text-sm mb-1">Start Time</label>
                                <input type="time" x-model="startTime" class="w-full p-2 border rounded-md">
                            </div>
                            <div>
                                <label class="block text-sm mb-1">End Time</label>
                                <input type="time" x-model="endTime" class="w-full p-2 border rounded-md">
                            </div>
                        </div>
                        <div class="mt-3">
                            <label class="block text-sm mb-1">Time Interval (minutes)</label>
                            <select x-model="timeInterval" class="w-full p-2 border rounded-md">
                                <option value="15">15</option>
                                <option value="30">30</option>
                                <option value="60">60</option>
                            </select>
                        </div>
                        <div class="mt-3">
                            <label class="block text-sm mb-1">Content Sections</label>
                            <select x-model="dailyContent" class="w-full p-2 border rounded-md">
                                <option value="both">Schedule + Notes</option>
                                <option value="schedule">Schedule Only</option>
                                <option value="notes">Notes Only</option>
                                <option value="none">Empty Lines Only</option>
                            </select>
                        </div>
                    </div>
                </template>
                
                <!-- Monthly View Options -->
                <template x-if="viewMode === 'monthly'">
                    <div class="mb-6">
                        <h3 class="font-medium mb-2">Monthly View Options</h3>
                        <label class="flex items-center mb-2">
                            <input type="checkbox" x-model="showHolidays" class="mr-2">
                            <span>Show Holidays</span>
                        </label>
                        <label class="flex items-center mb-2">
                            <input type="checkbox" x-model="showMoonPhases" class="mr-2">
                            <span>Show Moon Phases</span>
                        </label>
                        <div class="mt-3">
                            <label class="block text-sm mb-1">Country for Holidays</label>
                            <select x-model="country" class="w-full p-2 border rounded-md">
                                <option value="US">United States</option>
                                <option value="GB">United Kingdom</option>
                                <option value="CA">Canada</option>
                                <option value="AU">Australia</option>
                                <option value="DE">Germany</option>
                                <option value="FR">France</option>
                                <option value="JP">Japan</option>
                            </select>
                        </div>
                    </div>
                </template>
                
                <!-- Theme Customization -->
                <div class="mb-6">
                    <h3 class="font-medium mb-2">Theme</h3>
                    <div class="grid grid-cols-2 gap-4 mb-3">
                        <div>
                            <label class="block text-sm mb-1">Font Family</label>
                            <select x-model="fontFamily" class="w-full p-2 border rounded-md">
                                <option value="font-inter">Inter</option>
                                <option value="font-roboto">Roboto</option>
                                <option value="font-playfair">Playfair Display</option>
                                <option value="font-montserrat">Montserrat</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm mb-1">Font Size</label>
                            <select x-model="fontSize" class="w-full p-2 border rounded-md">
                                <option value="text-sm">Small</option>
                                <option value="text-base">Medium</option>
                                <option value="text-lg">Large</option>
                            </select>
                        </div>
                    </div>
                    <div class="grid grid-cols-2 gap-4 mb-3">
                        <div>
                            <label class="block text-sm mb-1">Text Color</label>
                            <input type="color" x-model="textColor" class="w-full h-10">
                        </div>
                        <div>
                            <label class="block text-sm mb-1">Grid Color</label>
                            <input type="color" x-model="gridColor" class="w-full h-10">
                        </div>
                    </div>
                    <div>
                        <label class="block text-sm mb-1">Background Color</label>
                        <input type="color" x-model="backgroundColor" class="w-full h-10">
                    </div>
                    <div class="mt-3">
                        <label class="block text-sm mb-1">Theme Presets</label>
                        <div class="flex gap-2 mt-1">
                            <button @click="applyTheme('default')" class="px-3 py-1 bg-indigo-600 text-white rounded text-xs">Default</button>
                            <button @click="applyTheme('dark')" class="px-3 py-1 bg-gray-800 text-white rounded text-xs">Dark</button>
                            <button @click="applyTheme('pastel')" class="px-3 py-1 bg-pink-200 text-pink-800 rounded text-xs">Pastel</button>
                            <button @click="applyTheme('grayscale')" class="px-3 py-1 bg-gray-200 text-gray-800 rounded text-xs">Grayscale</button>
                        </div>
                    </div>
                </div>
                
                <!-- Generate Button -->
                <div class="flex justify-between">
                    <button @click="resetSettings" class="px-4 py-2 bg-gray-200 text-gray-700 rounded-md hover:bg-gray-300 transition">
                        Reset
                    </button>
                    <button @click="generateCalendar" class="px-6 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700 transition">
                        Generate Calendar
                    </button>
                </div>
            </div>
          
            <!-- Calendar Generating -->
            <div class="no-print w-full lg:w-2/3 flex flex-col gap-4" x-show="loading">
                <!-- Calendar Output Container -->
                <div class="bg-white p-4 rounded-lg shadow-md overflow-auto">
                    <!-- Loading State -->
                    <div class="text-center py-10">
                        <div class="animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-indigo-600 mx-auto mb-4"></div>
                        <p>Generating calendar...</p>
                    </div>
                </div>
            </div>
            
            <!-- Calendar Preview/Output -->
            <div class="w-full lg:w-2/3 flex flex-col gap-4" x-show="generating && !loading">
                <div class="no-print flex justify-between items-center mb-2">
                    <h2 class="text-xl font-semibold text-indigo-700">Preview</h2>
                    <div class="flex justify-end">
                      <button x-show="generating" @click="backToSettings" class="m-2 px-4 py-2 bg-indigo-600 text-white rounded-md">
                        Back to Settings
                      </button>
                      <button @click="window.print()" class="m-2 px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700 transition">
                        <i class="fas fa-print"></i> Print
                      </button>
                    </div>
                </div>
                
                <!-- Calendar Output Container -->
                <div class="bg-white p-4 rounded-lg shadow-md overflow-auto">
                    <!-- Loading State -->
                    <div x-show="loading" class="text-center py-10">
                        <div class="animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-indigo-600 mx-auto mb-4"></div>
                        <p>Generating calendar...</p>
                    </div>
                    
                    <!-- Calendar Output -->
                    <div x-show="!loading" x-bind:class="[fontFamily, orientation === 'landscape' ? '' : 'max-w-2xl mx-auto', fontSize]">
                        <!-- Monthly Calendar -->
                        <template x-if="viewMode === 'monthly' && generating">
                            <div x-html="monthlyCalendarHTML" class="calendar-print"></div>
                        </template>
                        
                        <!-- Daily Calendar -->
                        <template x-if="viewMode === 'daily' && generating">
                            <div x-html="dailyCalendarHTML" class="calendar-print"></div>
                        </template>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        document.addEventListener('alpine:init', () => {
            Alpine.data('calendarApp', () => ({
                // View Mode
                viewMode: 'monthly',
                
                // Date Range
                startDate: new Date().toISOString().split('T')[0],
                endDate: new Date(new Date().setDate(new Date().getDate() + 7)).toISOString().split('T')[0],
                startMonth: new Date().toISOString().slice(0, 7),
                endMonth: new Date(new Date().setMonth(new Date().getMonth() + 1)).toISOString().slice(0, 7),
                
                // Layout Settings
                weekStartsOn: '0',
                orientation: 'portrait',
                layoutStyle: 'minimalist',
                
                // Daily View Options
                showQuote: true,
                showMoonPhase: true,
                timeFormat: '24h',
                startTime: '08:00',
                endTime: '18:00',
                timeInterval: '30',
                dailyContent: 'both',
                
                // Monthly View Options
                showHolidays: true,
                showMoonPhases: true,
                country: 'US',
                
                // Theme Settings
                fontFamily: 'font-inter',
                fontSize: 'text-base',
                textColor: '#3f3844',
                gridColor: '#e2e8f0',
                backgroundColor: '#ffffff',
                
                // State
                generating: false,
                loading: false,
                monthlyCalendarHTML: '',
                dailyCalendarHTML: '',
                quotes: [
                    "The only limit to our realization of tomorrow is our doubts of today. — Franklin D. Roosevelt",
                    "Success is not final, failure is not fatal: It is the courage to continue that counts. — Winston Churchill",
                    "The future depends on what you do today. — Mahatma Gandhi",
                    "Believe you can and you're halfway there. — Theodore Roosevelt",
                    "Strive not to be a success, but rather to be of value. — Albert Einstein"
                ],
                holidays: {
                    US: {
                        '01-01': "New Year's Day",
                        '01-16': "Martin Luther King Jr. Day",
                        '02-20': "Presidents' Day",
                        '05-29': "Memorial Day",
                        '07-04': "Independence Day",
                        '09-04': "Labor Day",
                        '10-09': "Columbus Day",
                        '11-11': "Veterans Day",
                        '11-23': "Thanksgiving",
                        '12-25': "Christmas Day"
                    },
                    GB: {
                        '01-01': "New Year's Day",
                        '04-07': "Good Friday",
                        '04-10': "Easter Monday",
                        '05-01': "Early May Bank Holiday",
                        '05-29': "Spring Bank Holiday",
                        '08-28': "Summer Bank Holiday",
                        '12-25': "Christmas Day",
                        '12-26': "Boxing Day"
                    },
                    CA: {
                        '01-01': "New Year's Day",
                        '02-20': "Family Day",
                        '04-07': "Good Friday",
                        '05-22': "Victoria Day",
                        '07-01': "Canada Day",
                        '09-04': "Labour Day",
                        '10-09': "Thanksgiving",
                        '11-11': "Remembrance Day",
                        '12-25': "Christmas Day"
                    }
                },
                
                // Methods
                generateCalendar() {
                    this.loading = true;
                    this.generating = true;
                    
                    if (this.viewMode === 'monthly') {
                        this.generateMonthlyCalendar();
                    } else {
                        this.generateDailyCalendar();
                    }
                    
                    setTimeout(() => {
                        this.loading = false;
                        // Scroll to top of calendar output
                        document.querySelector('[x-html]').scrollIntoView({ behavior: 'smooth' });
                    }, 500);
                },
                
                generateMonthlyCalendar() {
                    let html = '';
                    const months = this.getMonthsBetween(this.startMonth, this.endMonth);
                    
                    months.forEach(month => {
                        const year = month.getFullYear();
                        const monthName = month.toLocaleString('default', { month: 'long' });
                        const daysInMonth = new Date(year, month.getMonth() + 1, 0).getDate();
                        const firstDay = new Date(year, month.getMonth(), 1).getDay();
                        const adjust = this.weekStartsOn === '0' ? 0 : 1;
                        const startDay = (firstDay - adjust + 7) % 7;
                        
                        // Calendar wrapper with page settings
                        html += `
                            <div class="calendar-page mb-8 ${this.orientation === 'landscape' ? 'flex' : ''}" 
                                 style="color: ${this.textColor}; background-color: ${this.backgroundColor};">
                                <div class="${this.orientation === 'landscape' ? 'w-1/2' : ''}">
                                    <h2 class="text-2xl font-bold mb-4 text-center">${monthName} ${year}</h2>
                                    <table class="w-full" style="border-color: ${this.gridColor};">
                                        <thead>
                                            <tr>
                                                ${['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'].slice(adjust, 7).concat(adjust ? ['Sun'] : []).map(day => 
                                                    `<th class="py-2 border-b-2 font-medium" style="border-color: ${this.gridColor};">${day}</th>`
                                                ).join('')}
                                            </tr>
                                        </thead>
                                        <tbody>
                        `;
                        
                        let day = 1;
                        let isFirstWeek = true;
                        
                        for (let i = 0; i < 6; i++) {
                            if (day > daysInMonth) break;
                            
                            html += '<tr>';
                            
                            for (let j = 0; j < 7; j++) {
                                if (isFirstWeek && j < startDay) {
                                    html += '<td class="border" style="border-color: ${this.gridColor};"></td>';
                                } else if (day > daysInMonth) {
                                    html += '<td class="border" style="border-color: ${this.gridColor};"></td>';
                                } else {
                                    const currentDate = new Date(year, month.getMonth(), day);
                                    const dateStr = `${String(day).padStart(2, '0')}-${String(month.getMonth() + 1).padStart(2, '0')}`;
                                    const isWeekend = [0, 6].includes(currentDate.getDay());
                                    const isHoliday = this.showHolidays && this.holidays[this.country] && this.holidays[this.country][dateStr];
                                    const moonPhase = this.getMoonPhase(currentDate);
                                    
                                    html += `
                                        <td class="border p-1 ${isWeekend ? 'bg-opacity-10 bg-gray-300' : ''} 
                                            ${this.layoutStyle === 'detailed' ? 'h-32' : 'h-40'}" 
                                            style="border-color: ${this.gridColor};">
                                            <div class="h-full flex flex-col">
                                                <div class="flex justify-between items-center">
                                                    <span class="font-medium">${day}</span>
                                                    ${this.showMoonPhases ? `
                                                        <div class="moon-phase ${moonPhase.class}" 
                                                             style="background: ${moonPhase.background}; ${moonPhase.border ? 'border: 1px solid ' + this.textColor : ''}"></div>
                                                    ` : ''}
                                                </div>
                                                ${isHoliday ? `<div class="text-xs text-red-500">${isHoliday}</div>` : ''}
                                                <div class="flex-1 ${this.layoutStyle === 'detailed' ? 'py-1 overflow-hidden' : ''}">
                                                    ${Array.from({length: this.layoutStyle === 'detailed' ? 5 : 8}, (_, i) => 
                                                        `<div class="text-xs h-4 my-px" 
                                                              style="border-bottom: ${this.layoutStyle === 'detailed' ? '1px dashed ' + this.gridColor : 'none'}">
                                                         </div>`
                                                    ).join('')}
                                                </div>
                                            </div>
                                        </td>
                                    `;
                                    day++;
                                }
                            }
                            
                            html += '</tr>';
                            isFirstWeek = false;
                        }
                        
                        html += `
                                        </tbody>
                                    </table>
                                </div>
                                ${this.orientation === 'landscape' ? `
                                <div class="w-1/2 pl-4">
                                    <h3 class="text-lg font-semibold mb-2">Notes for ${monthName}</h3>
                                    <div class="border rounded p-2 h-full"
                                         style="border-color: ${this.gridColor}; min-height: 300px;">
                                        ${Array.from({length: 30}, () => 
                                            `<div class="h-6 border-b" style="border-color: ${this.gridColor};"></div>`
                                        ).join('')}
                                    </div>
                                </div>
                                ` : ''}
                            </div>
                        `;
                        
                        if (this.orientation === 'portrait') {
                            html += '<div class="page-break"></div>';
                        }
                    });
                    
                    this.monthlyCalendarHTML = html;
                },
                
                generateDailyCalendar() {
                    let html = '';
                    const days = this.getDaysBetween(this.startDate, this.endDate);
                    
                    days.forEach((day, index) => {
                        const date = new Date(day);
                        const dayName = date.toLocaleDateString('default', { weekday: 'long' });
                        const dateStr = `${String(date.getDate()).padStart(2, '0')}-${String(date.getMonth() + 1).padStart(2, '0')}`;
                        const isHoliday = this.showHolidays && this.holidays[this.country] && this.holidays[this.country][dateStr];
                        const moonPhase = this.getMoonPhase(date);
                        const startTime = parseInt(this.startTime.split(':')[0]);
                        const endTime = parseInt(this.endTime.split(':')[0]);
                        const interval = parseInt(this.timeInterval);
                        const timeSlots = [];
                        
                        // Create time slots
                        for (let hour = startTime; hour <= endTime; hour++) {
                            for (let minute = 0; minute < 60; minute += interval) {
                                const timeStr = this.timeFormat === '24h' 
                                    ? `${hour.toString().padStart(2, '0')}:${minute.toString().padStart(2, '0')}`
                                    : `${(hour > 12 ? hour - 12 : hour).toString().padStart(2, '0')}:${minute.toString().padStart(2, '0')} ${hour >= 12 ? 'PM' : 'AM'}`;
                                timeSlots.push(timeStr);
                            }
                        }
                        
                        html += `
                            <div class="daily-page mb-8 p-4" style="color: ${this.textColor}; background-color: ${this.backgroundColor};">
                                ${this.showQuote ? `
                                    <div class="text-center italic mb-2">
                                        ${this.quotes[Math.floor(Math.random() * this.quotes.length)]}
                                    </div>
                                ` : ''}
                                
                                <div class="text-center mb-4">
                                    <h2 class="text-3xl font-bold">${date.getDate()} ${date.toLocaleString('default', { month: 'long' })} ${date.getFullYear()}</h2>
                                    <h3 class="text-xl">${dayName}</h3>
                                    ${isHoliday ? `<div class="text-red-500 mt-1">${isHoliday}</div>` : ''}
                                    ${this.showMoonPhase ? `
                                        <div class="mt-2 flex justify-center items-center gap-2">
                                            <span class="text-sm">Moon:</span>
                                            <div class="moon-phase ${moonPhase.class}" 
                                                 style="background: ${moonPhase.background}; ${moonPhase.border ? 'border: 1px solid ' + this.textColor : ''}"></div>
                                            <span class="text-sm">${moonPhase.name}</span>
                                        </div>
                                    ` : ''}
                                </div>
                                
                                ${this.dailyContent !== 'none' ? `
                                    <div class="flex ${this.dailyContent === 'both' ? 'gap-4 flex-col md:flex-row' : ''}">
                                        ${this.dailyContent !== 'notes' ? `
                                            <div class="${this.dailyContent === 'both' ? 'md:w-1/2' : 'w-full'}">
                                                <h4 class="font-semibold mb-2 border-b pb-1" style="border-color: ${this.gridColor};">Schedule</h4>
                                                <table class="w-full">
                                                    ${timeSlots.map(time => `
                                                        <tr class="h-8">
                                                            <td class="w-16 align-top font-mono" style="border-color: ${this.gridColor};">
                                                                ${time}
                                                            </td>
                                                            <td style="border-bottom: ${this.layoutStyle === 'detailed' ? '1px dashed ' + this.gridColor : 'none'};">
                                                            </td>
                                                        </tr>
                                                    `).join('')}
                                                </table>
                                            </div>
                                        ` : ''}
                                        
                                        ${this.dailyContent !== 'schedule' ? `
                                            <div class="${this.dailyContent === 'both' ? 'md:w-1/2' : 'w-full'}">
                                                <h4 class="font-semibold mb-2 border-b pb-1" style="border-color: ${this.gridColor};">Notes</h4>
                                                <div style="min-height: ${timeSlots.length * 32}px;">
                                                    ${Array.from({length: Math.floor(timeSlots.length / 2)}, () => `
                                                        <div class="h-8 border-b" style="border-color: ${this.gridColor};"></div>
                                                    `).join('')}
                                                </div>
                                            </div>
                                        ` : ''}
                                    </div>
                                ` : `
                                    <div style="min-height: 400px;" class="border rounded" style="border-color: ${this.gridColor};">
                                        ${Array.from({length: 25}, () => `
                                            <div class="h-8 border-b" style="border-color: ${this.gridColor};"></div>
                                        `).join('')}
                                    </div>
                                `}
                                
                                <div class="mt-4 text-xs text-right">
                                    Page ${index + 1} of ${days.length}
                                </div>
                            </div>
                            <div class="page-break"></div>
                        `;
                    });
                    
                    this.dailyCalendarHTML = html;
                },
                
                getDaysBetween(startDate, endDate) {
                    const dates = [];
                    const start = new Date(startDate);
                    const end = new Date(endDate);
                    
                    while (start <= end) {
                        dates.push(new Date(start));
                        start.setDate(start.getDate() + 1);
                    }
                    
                    return dates;
                },
                
                getMonthsBetween(startMonth, endMonth) {
                    const months = [];
                    const [startYear, startMonthNum] = startMonth.split('-').map(Number);
                    const [endYear, endMonthNum] = endMonth.split('-').map(Number);
                    
                    let currentMonth = new Date(startYear, startMonthNum - 1, 1);
                    const endMonthDate = new Date(endYear, endMonthNum, 1);
                    
                    while (currentMonth < endMonthDate) {
                        months.push(new Date(currentMonth));
                        currentMonth.setMonth(currentMonth.getMonth() + 1);
                    }
                    
                    return months;
                },
                
                getMoonPhase(date) {
                    // Simplified moon phase calculation
                    const year = date.getFullYear();
                    const month = date.getMonth() + 1;
                    const day = date.getDate();
                    
                    // Rough calculation of moon age (0-29.5 days)
                    const c = Math.floor(year / 100);
                    let y = year % 100;
                    let l = ((month + 9) % 12) + 1;
                    let m = Math.floor(3.44 + (0.933 * l) + (0.034 * y) + (0.007 * c));
                    let moonAge = (0.33 + day + (1.73 * m)) % 29.53;
                    
                    // Determine phase
                    if (moonAge < 1.84566) return { name: "New Moon", class: "new", background: "transparent", border: true };
                    if (moonAge < 5.53699) return { name: "Waxing Crescent", class: "waxing-crescent", background: `linear-gradient(90deg, transparent 50%, ${this.textColor} 50%)` };
                    if (moonAge < 9.22831) return { name: "First Quarter", class: "first-quarter", background: this.textColor };
                    if (moonAge < 12.91963) return { name: "Waxing Gibbous", class: "waxing-gibbous", background: "radial-gradient(circle at 75% 50%, transparent 50%, " + this.textColor + " 50%)" };
                    if (moonAge < 16.61096) return { name: "Full Moon", class: "full", background: this.textColor };
                    if (moonAge < 20.30228) return { name: "Waning Gibbous", class: "waning-gibbous", background: "radial-gradient(circle at 25% 50%, transparent 50%, " + this.textColor + " 50%)" };
                    if (moonAge < 23.99361) return { name: "Last Quarter", class: "last-quarter", background: this.textColor };
                    if (moonAge < 27.68493) return { name: "Waning Crescent", class: "waning-crescent", background: `linear-gradient(90deg, ${this.textColor} 50%, transparent 50%)` };
                    return { name: "New Moon", class: "new", background: "transparent", border: true };
                },
                
                exportToPDF() {
                    // In a real app, you would use a PDF generation library like jsPDF or window.print()
                    alert("In a complete application, this would generate and download a PDF. For this demo, please use the Print function.");
                },
                
                backToSettings() {
                    this.generating = false;
                },
                
                resetSettings() {
                    // View Mode
                    this.viewMode = 'monthly';
                    
                    // Date Range
                    const today = new Date();
                    this.startDate = today.toISOString().split('T')[0];
                    this.endDate = new Date(today.setDate(today.getDate() + 7)).toISOString().split('T')[0];
                    this.startMonth = today.toISOString().slice(0, 7);
                    this.endMonth = new Date(today.setMonth(today.getMonth() + 1)).toISOString().slice(0, 7);
                    
                    // Layout Settings
                    this.weekStartsOn = '0';
                    this.orientation = 'portrait';
                    this.layoutStyle = 'minimalist';
                    
                    // Daily View Options
                    this.showQuote = true;
                    this.showMoonPhase = true;
                    this.timeFormat = '24h';
                    this.startTime = '08:00';
                    this.endTime = '18:00';
                    this.timeInterval = '30';
                    this.dailyContent = 'both';
                    
                    // Monthly View Options
                    this.showHolidays = true;
                    this.showMoonPhases = true;
                    this.country = 'US';
                    
                    // Theme Settings
                    this.fontFamily = 'font-inter';
                    this.fontSize = 'text-base';
                    this.textColor = '#3f3844';
                    this.gridColor = '#e2e8f0';
                    this.backgroundColor = '#ffffff';
                },
                
                applyTheme(theme) {
                    switch (theme) {
                        case 'default':
                            this.textColor = '#3f3844';
                            this.gridColor = '#e2e8f0';
                            this.backgroundColor = '#ffffff';
                            break;
                        case 'dark':
                            this.textColor = '#e2e8f0';
                            this.gridColor = '#4a5568';
                            this.backgroundColor = '#1a202c';
                            break;
                        case 'pastel':
                            this.textColor = '#5a3d2b';
                            this.gridColor = '#d1c7b7';
                            this.backgroundColor = '#fff4e6';
                            break;
                        case 'grayscale':
                            this.textColor = '#333333';
                            this.gridColor = '#cccccc';
                            this.backgroundColor = '#ffffff';
                            break;
                    }
                }
            }));
        });
    </script>
</body>
</html>
